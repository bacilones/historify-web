"use strict";!function(){angular.module("historify",["historify.core"]).controller("MapController",["$scope","$http",function(o,a){o.markers=[],o.removeAllMarkers=function(){o.markers.forEach(function(o){o.setMap(null)}),o.markers=[]},o.map=new google.maps.Map(document.getElementById("map"),{zoom:17,center:{lat:-33.434678,lng:-70.63578}});var e={method:"GET",url:"http://api.historify.cl/historicalevent",params:{}};a(e).then(function(e){e.data.forEach(function(e){var t=new google.maps.Marker({position:{lat:parseFloat(e.lat),lng:parseFloat(e.long)},label:e.name,map:o.map,icon:"./resources/img/historical_event_marker.png"});t.addListener("click",function(){console.log("marker presed",e.id);var t={method:"GET",url:"http://api.historify.cl/historicalevent/"+e.id};a(t).then(function(a){o.removeAllMarkers(),a.data.point_of_views.forEach(function(a){var e=new google.maps.Marker({position:{lat:parseFloat(a.lat),lng:parseFloat(a.long)},label:a.title,map:o.map,icon:"./resources/img/point_of_view.png"}),t=new google.maps.InfoWindow({content:a.content});e.addListener("click",function(){t.open(o.map,e)}),o.markers.push(e)});new google.maps.Marker({position:{lat:parseFloat(a.data.lat),lng:parseFloat(a.data.long)},label:a.data.name,map:o.map,icon:"./resources/img/historical_event_marker.png"});o.map.setZoom(15)}).catch(function(o){console.log(o)})}),o.markers.push(t)}),console.log("markers -->",o.markers)}).catch(function(o){console.log(o)})}])}();